### cookies、sessionStorage、localStorage 和 indexDB 的区别

- cookie是网站为了标示用户身份而储存在用户本地的数据

- 是否在http请求只能够携带

- - cookie数据始终在**同源**的http请求中携带，跨域需要设置`withCredentials = true`
  - sessionStorage和localStorage不会自动把数据发给服务器，仅在本地保存

- 存储大小：

- - cookie数据大小不能超过`4k`；
  - sessionStorage和localStorage虽然也有存储大小的限制，但比cookie大得多，可以达到`5M`或更大，因不同浏览器大小不同；

- 有效时间：

- - cookie 设置的cookie过期时间之前一直有效，即使窗口或浏览器关闭
  - localStorage 硬盘存储持久数据，浏览器关闭后数据不丢失除非主动删除数据
  - sessionStorage 存在内存中，数据在当前浏览器窗口关闭后自动删除

画表对比：

|     特性     |                   cookie                   |       localStorage       | sessionStorage |         indexDB          |
| :----------: | :----------------------------------------: | :----------------------: | :------------: | :----------------------: |
| 数据生命周期 |     一般由服务器生成，可以设置过期时间     | 除非被清理，否则一直存在 | 页面关闭就清理 | 除非被清理，否则一直存在 |
| 数据存储大小 |                   **4K**                   |          **5M**          |     **5M**     |           无限           |
| 与服务端通信 | 每次都会携带在 header 中，对于请求性能影响 |          不参与          |     不参与     |          不参与          |

对于 `cookie`，还需要注意安全性：

|    属性     |                             作用                             |
| :---------: | :----------------------------------------------------------: |
|   `value`   | 如果用于保存用户登录态，应该将该值加密，不能使用明文的用户标识 |
| `http-only` |          不能通过 `JS`访问 `Cookie`，减少 `XSS`攻击          |
|  `secure`   |              只能在协议为 `HTTPS` 的请求中携带               |
| `same-site` |  规定浏览器不能在跨域请求中携带 `Cookie`，减少 `CSRF` 攻击   |